<!DOCTYPE html>
<meta charset="utf-8">
<link rel="stylesheet" type="text/css" href="style.css">
<body>
<script src="http://d3js.org/d3.v3.min.js"></script>
<script>

var outerRadius = 960 / 2,
    innerRadius = outerRadius - 130;

var fill = d3.scale.category20c();

var chord = d3.layout.chord()
    .padding(.04)
    .sortSubgroups(d3.descending)
    .sortChords(d3.descending);

var arc = d3.svg.arc()
    .innerRadius(innerRadius)
    .outerRadius(innerRadius + 20);

var svg = d3.select("body").append("svg")
    .attr("width", outerRadius * 2)
    .attr("height", outerRadius * 2)
  .append("g")
    .attr("transform", "translate(" + outerRadius + "," + outerRadius + ")");

//d3.json("readme.json", function(error, imports) {
setTimeout(function () {
  var matrix = [],
      n = 0;

  //
  // TODO: Dont' use hard-coded values.
  //
  var names = [ 'async',
  'colors',
  'commander',
  'express',
  'lodash',
  'moment',
  'optimist',
  'redis',
  'request',
  'underscore',
  'winston' ];

  chord.matrix([
    [ 240, 207, 163, 133, 126, 88, 82, 82, 82, 0, 69 ],
    [ 0, 648, 553, 365, 314, 345, 225, 0, 0, 0, 0 ],
    [ 648, 0, 1359, 786, 448, 522, 406, 307, 0, 0, 0 ],
    [ 553, 1359, 0, 837, 534, 557, 484, 0, 648, 0, 0 ],
    [ 365, 786, 837, 0, 335, 324, 313, 0, 296, 0, 0 ],
    [ 314, 448, 534, 335, 0, 0, 395, 0, 166, 0, 0 ],
    [ 345, 522, 557, 324, 0, 0, 477, 0, 189, 0, 0 ],
    [ 225, 406, 484, 313, 395, 477, 0, 0, 185, 0, 0 ],
    [ 170, 307, 316, 194, 87, 134, 117, 0, 157, 0, 0 ],
    [ 191, 0, 648, 296, 166, 189, 185, 157, 0, 0, 0 ],
    [ 171, 184, 234, 87, 67, 0, 0, 68, 0, 0, 0 ]
  ]);

  var g = svg.selectAll(".group")
      .data(chord.groups)
    .enter().append("g")
      .attr("class", "group");

  g.append("path")
      .style("fill", function(d) { return fill(d.index); })
      .style("stroke", function(d) { return fill(d.index); })
      .attr("d", arc);

  g.append("text")
      .each(function(d) { d.angle = (d.startAngle + d.endAngle) / 2; })
      .attr("dy", ".35em")
      .attr("transform", function(d) {
        return "rotate(" + (d.angle * 180 / Math.PI - 90) + ")"
            + "translate(" + (innerRadius + 26) + ")"
            + (d.angle > Math.PI ? "rotate(180)" : "");
      })
      .style("text-anchor", function(d) { return d.angle > Math.PI ? "end" : null; })
      .text(function(d) { return names[d.index]; });

  svg.selectAll(".chord")
      .data(chord.chords)
    .enter().append("path")
      .attr("class", "chord")
      .style("stroke", function(d) { return d3.rgb(fill(d.source.index)).darker(); })
      .style("fill", function(d) { return fill(d.source.index); })
      .attr("d", d3.svg.chord().radius(innerRadius));

}, 100);

d3.select(self.frameElement).style("height", outerRadius * 2 + "px");

</script>
